/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/integration/designtime/controls/PropertyEditor","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/IconPool"],function(e,t,i,o,n,a){"use strict";var r=e.extend("sap.ui.integration.designtime.controls.propertyEditors.IconEditor",{init:function(){this._oIconModel=new i(a.getIconNames().map(function(e){return{name:e,path:"sap-icon://"+e}}));this._oInput=new sap.m.Input({value:"{value}",showSuggestion:true,showValueHelp:true,valueHelpRequest:this._handleValueHelp.bind(this)});this._oInput.setModel(this._oIconModel,"icons");this._oInput.bindAggregation("suggestionItems","icons>/",new sap.ui.core.ListItem({text:"{icons>path}",additionalText:"{icons>name}"}));this._oInput.attachLiveChange(function(e){this.firePropertyChanged(e.getParameter("value"))}.bind(this));this._oInput.attachSuggestionItemSelected(function(e){this.firePropertyChanged(e.getParameter("selectedItem").getText())}.bind(this));this.addContent(this._oInput)},renderer:e.getMetadata().getRenderer().render});r.prototype._handleValueHelp=function(e){var i=e.getSource().getValue();if(!this._oDialog){t.load({name:"sap.ui.integration.designtime.controls.propertyEditors.IconSelection",controller:this}).then(function(e){this._oDialog=e;this.addDependent(this._oDialog);this._oDialog.setModel(this._oIconModel);this._filter(i);this._oDialog.open(i)}.bind(this))}else{this._filter(i);this._oDialog.open(i)}};r.prototype.handleSearch=function(e){var t=e.getParameter("value");this._filter(t)};r.prototype._filter=function(e){var t=new o("path",n.Contains,e);var i=this._oDialog.getBinding("items");i.filter([t])};r.prototype.handleClose=function(e){var t=e.getParameter("selectedItem");if(t){this.firePropertyChanged(t.getIcon())}e.getSource().getBinding("items").filter([])};return r});